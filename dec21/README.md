Part 2 is *extremely* slow in the naive python, so I needed to implement in C++
